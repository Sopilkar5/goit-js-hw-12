{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"48661661-399e17c2888aa32e2cfb6a652\";\n\nexport const fetchImages = async (query, page = 1) => {\n  try {\n    const response = await axios.get(\"https://pixabay.com/api/\", {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: page,\n        per_page: 40, \n      },\n    });\n\n    return {\n      images: response.data.hits,\n      totalHits: response.data.totalHits,\n    };\n  } catch (error) {\n    console.error(\"Error fetching images: \", error.response?.data || error.message);\n    throw new Error(\"Unable to fetch images.\");  \n  }\n};\n\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst scrollToNewImages = () => {\n  const galleryCards = document.querySelectorAll(\".gallery-card\");\n\n  if (galleryCards.length > 0) {\n    const cardHeight = galleryCards[0].getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2, \n      behavior: \"smooth\", \n    });\n  }\n};\n\nexport const renderImages = (images) => {\n  const gallery = document.getElementById(\"gallery\");\n\n  if (images.length === 0) {\n    showNoResultsMessage();\n    return;\n  }\n\n  images.forEach((image) => {\n    const card = document.createElement(\"div\");\n    card.classList.add(\"gallery-card\");\n\n    const link = document.createElement(\"a\");\n    link.href = image.largeImageURL;\n    link.classList.add(\"gallery-link\");\n\n    const imgElement = document.createElement(\"img\");\n    imgElement.src = image.webformatURL;\n    imgElement.alt = image.tags;\n    imgElement.classList.add(\"gallery-image\");\n\n    const info = document.createElement(\"div\");\n    info.classList.add(\"image-info\");\n    info.innerHTML = `\n      <p><strong>Likes:</strong> ${image.likes}</p>\n      <p><strong>Views:</strong> ${image.views}</p>\n      <p><strong>Comments:</strong> ${image.comments}</p>\n      <p><strong>Downloads:</strong> ${image.downloads}</p>\n    `;\n\n    link.appendChild(imgElement);\n    card.appendChild(link);\n    card.appendChild(info);\n\n    gallery.appendChild(card);\n  });\n\n  const lightbox = new SimpleLightbox('.gallery-link', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  lightbox.refresh();\n\n  scrollToNewImages();\n};\n\n\nexport const showNoResultsMessage = () => {\n  iziToast.error({\n    message: \"Sorry, there are no images matching your search query. Please try again!\",\n    position: \"topRight\",\n    backgroundColor: `#ef4040`,\n    onOpening: function () {\n      const toastElement = document.querySelector('.iziToast');\n      if (toastElement) {\n        toastElement.style.borderBottom = '2px solid #ffbebe';\n        toastElement.style.borderRadius = '4px';\n        toastElement.style.padding = '20px';\n        toastElement.style.width = '432px';\n        toastElement.style.height = '88px';\n      }\n    }\n  });\n};\n\nexport const showErrorMessage = (message) => {\n  iziToast.error({\n    title: \"Error\",\n    message: message,\n    position: \"topRight\",\n  });\n};\n","import { fetchImages } from './js/pixabay-api.js';\nimport { renderImages, showErrorMessage, showNoResultsMessage } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.getElementById(\"search-input\");\nconst searchButton = document.querySelector(\"button\");\nconst gallery = document.getElementById(\"gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.getElementById(\"load-more-btn\");\n\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet totalHits = 0; \n\nsearchForm.classList.add(\"search-form\");\nsearchInput.classList.add(\"search-input\");\nsearchButton.classList.add(\"search-button\");\ngallery.classList.add(\"gallery\");\n\nsearchForm.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n\n\n  const query = searchInput.value.trim();\n  if (!query) {\n    showErrorMessage(\"Please enter a search term.\");\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  totalHits = 0; \n\n  gallery.innerHTML = \"\";\n  loadMoreBtn.style.display = \"none\"; \n\n  loader.style.display = \"block\"; \n\n  try {\n    const { images, totalHits: total } = await fetchImages(currentQuery, currentPage);\n    totalHits = total; \n\n    if (images.length === 0) {\n      showNoResultsMessage(); \n      return;\n    }\n\n    renderImages(images);\n\n    if (images.length > 0) {\n      gallery.insertAdjacentElement(\"afterend\", loadMoreBtn);\n      loadMoreBtn.style.display = \"block\";\n    }\n\n    if (totalHits <= 40) {\n      loadMoreBtn.style.display = \"none\";\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    showErrorMessage(\"Failed to fetch images. Please try again later.\");\n  } finally {\n    loader.style.display = \"none\"; \n  }\n\n  searchInput.value = \"\";\n});\n\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  console.log(`Current Page: ${currentPage}, Total Hits: ${totalHits}`);\n  \n  if ((currentPage - 1) * 40 >= totalHits) {\n    console.log(\"No more images to load.\");\n    loadMoreBtn.style.display = \"none\";\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  currentPage += 1;\n  loadMoreBtn.insertAdjacentElement(\"afterend\", loader);\n  loader.style.display = \"block\"; \n\n  try {\n    console.log(`Fetching images for page ${currentPage}...`);\n    const { images, totalHits: total } = await fetchImages(currentQuery, currentPage);\n    totalHits = total; \n\n    console.log(`Images received on page ${currentPage}:`, images.length);\n\n    if (images.length === 0 || currentPage * 40 >= totalHits) {\n      console.log(\"Reached the end of results.\");\n      loadMoreBtn.style.display = \"none\";\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      renderImages(images);\n    }\n  } catch (error) {\n    console.error(\"Error fetching more images:\", error);\n    showErrorMessage(\"Failed to fetch more images. Please try again later.\");\n  } finally {\n    loader.style.display = \"none\"; \n  }\n});\n"],"names":["API_KEY","fetchImages","query","page","response","axios","error","_a","scrollToNewImages","galleryCards","cardHeight","renderImages","images","gallery","showNoResultsMessage","image","card","link","imgElement","info","SimpleLightbox","iziToast","toastElement","showErrorMessage","message","searchForm","searchInput","searchButton","loader","loadMoreBtn","currentPage","currentQuery","totalHits","total"],"mappings":"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"}